<% layout('/layouts/boilerplate') %>
<style>
  #filter-component-wrapper {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
      Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue",
      sans-serif;
    padding: 1rem 0; /* Provides some vertical spacing for the component */
  }

  /* --- Main Container for Layout --- */
  #filter-component-wrapper .outer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 2rem;
    /* Removed padding/shadow/background from here to be more modular */
  }

  /* --- Filter Items Container --- */
  #filter-component-wrapper #filters {
    display: flex;
    align-items: center;
    gap: 1.5rem; /* Space between filter items */
    flex-grow: 1; /* Allows it to take available space */
    overflow-x: auto;
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
    justify-content: space-evenly;
  }

  #filter-component-wrapper #filters::-webkit-scrollbar {
    display: none;
  }

  /* --- Individual Filter Item --- */
  #filter-component-wrapper .filter {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    color: #6c757d;
    cursor: pointer;
    opacity: 0.7;
    transition: opacity 0.2s ease;
    flex-shrink: 0;
  }

  #filter-component-wrapper .filter:hover {
    opacity: 1;
  }

  #filter-component-wrapper .filter i {
    font-size: 1.25rem;
  }

  #filter-component-wrapper .filter .para {
    font-size: 0.8rem;
    font-weight: 600;
    white-space: nowrap;
    margin: 0;
  }

  /* --- Tax Switch --- */
  #filter-component-wrapper .tax-switch {
    border: 1px solid #dee2e6;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    flex-shrink: 0;
  }

  #filter-component-wrapper .tax-switch .form-check-label {
    font-weight: 600;
  }

  /* =========================================== */
  /* --- RESPONSIVE STYLES (MEDIA QUERIES) --- */
  /* =========================================== */

  @media (max-width: 992px) {
    #filter-component-wrapper .outer {
      flex-direction: column;
      align-items: center;
      gap: 1.5rem;
    }
  }

  @media (max-width: 768px) {
    #filter-component-wrapper #filters {
      flex-wrap: wrap;
      justify-content: center;
      overflow-x: visible;
    }
  }
  .tax-info {
    display: none;
  }
</style>
<div id="filter-component-wrapper">
  <div class="outer">
    <div id="filters">
      <div class="filter">
        <div><i class="fa-solid fa-fire"></i></div>
        <p class="para">Trending</p>
      </div>
      <div class="filter">
        <div><i class="fa-solid fa-bed"></i></div>
        <p class="para">Rooms</p>
      </div>
      <div class="filter">
        <div><i class="fa-solid fa-mountain-city"></i></div>
        <p class="para">Iconic Cities</p>
      </div>
      <div class="filter">
        <div><i class="fa-solid fa-mountain"></i></div>
        <p class="para">Mountains</p>
      </div>
      <div class="filter">
        <div><i class="fa-solid fa-house-chimney"></i></div>
        <p class="para">Castles</p>
      </div>
      <div class="filter">
        <div><i class="fa-solid fa-person-swimming"></i></div>
        <p class="para">Pools</p>
      </div>
      <div class="filter">
        <div><i class="fa-solid fa-campground"></i></div>
        <p class="para">Camping</p>
      </div>
      <div class="filter">
        <div><i class="fa-solid fa-tractor"></i></div>
        <p class="para">Farms</p>
      </div>
      <div class="filter">
        <div><i class="fa-solid fa-snowflake"></i></div>
        <p class="para">Arctic</p>
      </div>
      <div class="filter">
        <div><i class="fa-solid fa-igloo"></i></div>
        <p class="para">Domes</p>
      </div>
      <div class="filter">
        <div><i class="fa-solid fa-sailboat"></i></div>
        <p class="para">Boats</p>
      </div>
    </div>
    <div class="tax-switch">
      <div class="form-check-reverse form-switch">
        <input
          class="form-check-input"
          type="checkbox"
          role="switch"
          id="switchCheckDefault"
        />
        <label class="form-check-label" for="switchCheckDefault"
          >Check Taxes</label
        >
      </div>
    </div>
  </div>
</div>

<div class="row row-cols-lg-3 mt-2 row-cols-sm-1">
  <%for(let listing of allListings){%>
  <a href="/listings/<%= listing._id %>" class="listing-link">
    <div class="card col listing-card">
      <img
        src="<%- listing.image.url %>"
        class="card-img-top"
        alt="Listing_image"
        style="height: 20rem"
      />
      <div class="card-img-overlay"></div>
      <div class="card-body">
        <p class="card-text price-info">
          <b><%= listing.title %> </b><br />
          <span class="price-without-tax">
            &#8377;<%= listing.price.toLocaleString("en-IN") %> / night
          </span>
          <span class="price-with-tax" style="display: none">
            &#8377;<%= (listing.price * 1.18).toLocaleString("en-IN") %> / night
            <i style="font-size: smaller"> (includes 18% tax)</i>
          </span>
        </p>
      </div>
    </div>
  </a>
  <% }%>
</div>

<script>
  let taxSwitch = document.getElementById("switchCheckDefault");
  taxSwitch.addEventListener("click", () => {
    let allPrices = document.getElementsByClassName("price-info");
    for (let price of allPrices) {
      let priceWithoutTax = price.querySelector(".price-without-tax");
      let priceWithTax = price.querySelector(".price-with-tax");
      if (taxSwitch.checked) {
        priceWithoutTax.style.display = "none";
        priceWithTax.style.display = "inline";
      } else {
        priceWithoutTax.style.display = "inline";
        priceWithTax.style.display = "none";
      }
    }
  });
</script>
