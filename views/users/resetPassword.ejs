<%- layout("/layouts/boilerplate") %>
    <style>
      body {
        font-family: "Poppins", sans-serif;
        background: #f7f9fc;
      }
      .card {
        border: none;
        border-radius: 20px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.07);
      }
      .form-control:focus {
        box-shadow: none;
        border-color: #2196f3;
      }
      .btn-primary {
        background: linear-gradient(135deg, #1e88e5, #1565c0);
        border: none;
        padding: 12px;
        border-radius: 12px;
        font-weight: 600;
        letter-spacing: 0.5px;
      }
      .btn-primary:hover {
        background: linear-gradient(135deg, #1565c0, #0d47a1);
      }
    
    .page-bg {
      min-height: calc(100vh - 208px);
      
      width: 100%;
    }
    .center-wrapper {
      min-height: calc(100vh - 208px);
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }
    .center-box {
     min-height: calc(100vh - 208px);
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .was-validated .form-control:valid {
      background-image: none !important; /* Removes the tick mark icon */
      /* background-color: #d4edda;         Adds a light green background */
      border-color: #badbcc;             /* Optional: Matches border to background */
      color: #0f5132;                    /* Optional: Darker text for contrast */
    }

    /* Optional: Maintain the green styling when the user clicks back into the box */
    .was-validated .form-control:valid:focus {
      /* background-color: #d4edda; */
      box-shadow: 0 0 0 0.25rem rgba(25, 135, 84, 0.25); /* Green glow instead of blue */
    }
  </style>

  <body>
    <div class="page-bg">
      <div class="center-wrapper">
        <div class="container">
          <div class="row justify-content-center">
            <div class="col-md-5">
              <div
                class="card p-4"
                style="
                  background: #ffffff;
                  border-radius: 22px;
                  padding: 35px;
                  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
                  transition: 0.3s;
                "
              >
                <h4
                  class="text-center mb-3"
                  style="font-weight: 700; color: #1a237e; font-size: 1.6rem"
                >
                  Reset Password
                </h4>
                <p
                  class="text-center mb-4"
                  style="color: #5f6368; font-size: 15px"
                >
                  Enter your new password and confirm it below.
                </p>

                <form
                  class="needs-validation"
                  novalidate
                  action="/reset-password"
                  method="POST"
                >
                  <input type="hidden" name="token" value="<%= token %>" />
                  <div class="mb-3">
                    <label for="password" class="form-label"
                      >New Password</label
                    >
                    <input
                      type="password"
                      class="form-control"
                      id="password"
                      name="password"
                      placeholder="Enter new password"
                      required
                    />
                    <div class="invalid-feedback">
                      password should contain atleast one
                      UpperCase,lowercase,number&speicalCharacter
                    </div>
                  </div>

                  <div class="mb-3">
                    <label for="confirmPassword" class="form-label"
                      >Confirm Password</label
                    >
                    <input
                      type="password"
                      class="form-control"
                      id="confirmPassword"
                      name="confirmPassword"
                      placeholder="Confirm new password"
                      required
                    />
                    <div class="invalid-feedback">
                      Both passwords must match.
                    </div>
                  </div>

                  <button type="submit" class="btn btn-primary w-100">
                    Reset Password
                  </button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
      <script>
        const pass = document.getElementById("password");
        const cpass = document.getElementById("confirmPassword");

        // Password strength: 8 chars, uppercase, lowercase, number, special char
        const passwordRegex =
          /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;

        pass.addEventListener("input", () => {
          if (!passwordRegex.test(pass.value)) {
            pass.setCustomValidity(
              "Must be 8+ chars with uppercase, lowercase, number & special character."
            );
          } else {
            pass.setCustomValidity("");
          }
        });

        cpass.addEventListener("input", () => {
          if (cpass.value !== pass.value) {
            cpass.setCustomValidity("Passwords do not match");
          } else {
            cpass.setCustomValidity("");
          }
        });
      </script>
      <script>
        (() => {
          "use strict";
          const forms = document.querySelectorAll(".needs-validation");
          Array.from(forms).forEach((form) => {
            form.addEventListener(
              "submit",
              (event) => {
                if (!form.checkValidity()) {
                  event.preventDefault();
                  event.stopPropagation();
                }
                form.classList.add("was-validated");
              },
              false
            );
          });
        })();
      </script>
    </div>
  </body>
</html>
